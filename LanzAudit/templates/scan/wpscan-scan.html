{% extends 'base.html' %}

{% block title %}LanzAudit | Escaneo WPScan{% endblock %}
{% block page_title %}Escaneo WPScan{% endblock %}
{% block page_title_2 %}WPScan{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2><i class="bi bi-wordpress me-2"></i> Escaneos con WPScan</h2>
  <p>Selecciona el tipo de escaneo que deseas realizar y proporciona la información necesaria.</p>

  <form method="POST" action="{{ url_for('wpscanScan') }}">
    <div class="mb-3">
      <label for="target" class="form-label">Dirección del sitio WordPress</label>
      <input type="text" class="form-control" id="target" name="target" required placeholder="Ej: https://ejemplo.com">
    </div>

    <div class="mb-4">
      <label class="form-label">Tipo de escaneo</label>

      <div class="form-check">
        <input class="form-check-input" type="radio" name="scan_type" value="basic" id="basicScan" required>
        <label class="form-check-label" for="basicScan">
          <i class="bi bi-house-door me-1"></i> Escaneo Básico — Detecta temas y plugins comunes
        </label>
      </div>

      <div class="form-check">
        <input class="form-check-input" type="radio" name="scan_type" value="vulns" id="vulnScan">
        <label class="form-check-label" for="vulnScan">
          <i class="bi bi-shield-lock me-1"></i> Detección de Vulnerabilidades — Muestra vulnerabilidades conocidas
        </label>
      </div>

      <div class="form-check">
        <input class="form-check-input" type="radio" name="scan_type" value="plugins" id="pluginScan">
        <label class="form-check-label" for="pluginScan">
          <i class="bi bi-box me-1"></i> Escaneo de Plugins — Enumera los plugins instalados en el sitio
        </label>
      </div>

      <div class="form-check">
        <input class="form-check-input" type="radio" name="scan_type" value="themes" id="themeScan">
        <label class="form-check-label" for="themeScan">
          <i class="bi bi-palette me-1"></i> Escaneo de Temas — Enumera los temas activos del sitio
        </label>
      </div>

      <div class="form-check">
        <input class="form-check-input" type="radio" name="scan_type" value="users" id="userScan">
        <label class="form-check-label" for="userScan">
          <i class="bi bi-person me-1"></i> Escaneo de Usuarios — Detecta los usuarios registrados
        </label>
      </div>

      <div class="form-check">
        <input class="form-check-input" type="radio" name="scan_type" value="aggressive" id="aggressiveScan">
        <label class="form-check-label" for="aggressiveScan">
          <i class="bi bi-flame me-1"></i> Escaneo Avanzado — Detecta más información detallada sobre el sitio
        </label>
      </div>

      <div class="form-check">
        <input class="form-check-input" type="radio" name="scan_type" value="custom" id="customScan">
        <label class="form-check-label" for="customScan">
          <i class="bi bi-sliders2-vertical me-1"></i> Escaneo Personalizado — Escoge las opciones específicas que deseas escanear
        </label>
      </div>

      <div class="mt-2" id="customScanInput" style="display: none;">
        <input type="text" class="form-control mt-2" name="options" placeholder="Ej: --plugins-dir /ruta/a/archivos">
      </div>
    </div>

    <button type="submit" class="btn btn-success">
      <i class="bi bi-search me-1"></i> Iniciar escaneo
    </button>
  </form>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
  const customRadio = document.getElementById('customScan');
  const customInput = document.getElementById('customScanInput');
  const radios = document.querySelectorAll('input[name="scan_type"]');
  radios.forEach(radio => {
    radio.addEventListener('change', () => {
      customInput.style.display = customRadio.checked ? 'block' : 'none';
    });
  });
</script>
{% endblock %}

